<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üçø Lottie Playground</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.10.2/lottie.min.js"></script>
  <style>
    body { font-family: sans-serif; padding-bottom: 80px; }
    .controls { display: flex; flex-wrap: wrap; gap: 12px; margin: 16px; align-items: center; }
    .controls label { display: flex; flex-direction: column; font-size: 14px; }
    .controls input[type=number] { width: 80px; margin-top: 4px; }
    .controls button { padding: 6px 12px; cursor: pointer; }
    .preview { display: flex; flex-wrap: wrap; gap: 10px; padding: 0 16px; }
    .anim { position: relative; width: 200px; height: 200px; background: #eee; display: flex; align-items: center; justify-content: center; }
    .fps { position: absolute; top: 4px; right: 4px; background: rgba(0,0,0,0.6); color: #fff; font-size: 12px; padding: 2px 4px; border-radius: 3px; }
    .renderer-panel { position: fixed; bottom: 0; left: 0; width: 100%; background: #fafafa; border-top: 1px solid #ccc; padding: 10px 20px; display: flex; align-items: center; gap: 12px; box-shadow: 0 -2px 5px rgba(0,0,0,0.1); }
    .renderer-btn { padding: 6px 12px; cursor: pointer; border: 1px solid #ccc; background: #fff; }
    .renderer-btn.active { background: #007bff; color: #fff; border-color: #007bff; }
  </style>
</head>
<body>
  <h1 style="margin:16px;">üé¨ Lottie Playground</h1>
  <div class="controls">
    <label>Speed<input type="number" id="speed" value="1" step="0.1" /></label>
    <label>First Frame<input type="number" id="firstFrame" value="990" /></label>
    <label>Last Frame<input type="number" id="lastFrame" value="1070" /></label>
    <label>Loop<input type="checkbox" id="loop" checked /></label>
    <label>Count<input type="number" id="count" value="1" min="1" /></label>
    <button id="applyBtn">Apply Settings</button>
    <button id="playBtn">Play</button>
    <button id="pauseBtn">Pause</button>
  </div>

  <div class="preview" id="preview"></div>

  <div class="renderer-panel">
    <span>Renderer:</span>
    <button class="renderer-btn active" data-r="html">HTML</button>
    <button class="renderer-btn" data-r="svg">SVG</button>
    <button class="renderer-btn" data-r="canvas">Canvas</button>
  </div>

  <script>
    const LOTTIE_URL = 'https://raw.githubusercontent.com/herasimovich/host/refs/heads/main/lottie.json';
    let anims = [], fpsIntervals = [];
    let currentRenderer = 'html';
    const previewEl = document.getElementById('preview');
    const rendererButtons = document.querySelectorAll('.renderer-btn');

    rendererButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        rendererButtons.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentRenderer = btn.dataset.r;
        rebuild();
      });
    });

    function rebuild() {
      anims.forEach(a => a.destroy()); anims = [];
      fpsIntervals.forEach(i => clearInterval(i)); fpsIntervals = [];
      previewEl.innerHTML = '';

      const count = +document.getElementById('count').value;
      for (let i = 0; i < count; i++) {
        const box = document.createElement('div');
        box.className = 'anim'; previewEl.appendChild(box);

        const fpsEl = document.createElement('div');
        fpsEl.className = 'fps'; fpsEl.textContent = 'FPS: 0'; box.appendChild(fpsEl);

        const params = {
          container: box,
          renderer: currentRenderer,
          loop: document.getElementById('loop').checked,
          autoplay: false,
          path: LOTTIE_URL
        };
        const anim = lottie.loadAnimation(params);
        anims.push(anim);

        let frameCount = 0;
        anim.addEventListener('enterFrame', () => frameCount++);
        fpsIntervals.push(setInterval(() => { fpsEl.textContent = 'FPS: ' + frameCount; frameCount = 0; }, 1000));
      }
      applySettings();
    }

    function applySettings() {
      const speed = +document.getElementById('speed').value;
      const first = +document.getElementById('firstFrame').value;
      const last = +document.getElementById('lastFrame').value;
      const loop = document.getElementById('loop').checked;
      anims.forEach(a => { a.setSpeed(speed); a.loop = loop; a.playSegments([first, last], true); });
    }

    document.getElementById('applyBtn').addEventListener('click', rebuild);
    document.getElementById('playBtn').addEventListener('click', () => anims.forEach(a => a.play()));
    document.getElementById('pauseBtn').addEventListener('click', () => anims.forEach(a => a.pause()));

    rebuild();
  </script>
</body>
</html>
